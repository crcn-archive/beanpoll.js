<html>
	<head>
		<script src="index.min.js" type="text/javascript"></script>
		<script>

			beanpole.on({
				'pull confirm/*': function()
				{
					console.log("DELAYED")
					setTimeout(function(self){ self.next(); }, 500, this);	
				},
				'pull -rotate confirm/:secret': function()
				{
					if(prompt("What's the secret phrase? (pass)", "pass") == this.data.secret)
					{
						if(!this.next()) return "Correct!";
					}
					else
					{
						alert('Incorrect, try again.');

						var self = this;

						arguments.callee.apply(this, arguments);
					}
				},
				'pull -rotate=1 confirm/:secret': function()
				{
					console.log('rotated. no need to confirm!');

					if(!this.next()) return "No need to confirm!";
				},
				'pull -rotate confirm/pass -> hello/world': function()
				{
					return "Hello there!"
				},
				'pull -rotate=1 confirm/pass -> hello/world': function()
				{
					return "Hello again!"
				}
			});

			for(var i = 2; i--;)
			beanpole.pull('hello/world', function(response)
			{
				alert(response);
			});


			

		</script>
	</head>
</html>